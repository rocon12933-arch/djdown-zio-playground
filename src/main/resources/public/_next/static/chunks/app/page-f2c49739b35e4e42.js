(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{44620:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>W});var s=a(95155),r=a(63111),l=a(91158),n=a(20044),i=a(73259),c=a(78355),o=a(17412),d=a(80306),x=a(60679),h=a(97801),u=a(84520),m=a(1493),f=a(97376);let g={backend:{serverSide:""}};var j=a(19577),p=a(96362),k=a(51362),v=a(44823),y=a(52596),b=a(78519);let w=e=>{let{className:t,classNames:a}=e,{theme:r,setTheme:l}=(0,k.D)(),n=(0,v.wR)(),{Component:i,slots:c,isSelected:o,getBaseProps:d,getInputProps:x,getWrapperProps:h}=(0,p.K)({isSelected:"light"===r||n,"aria-label":"Switch to ".concat("light"===r||n?"dark":"light"," mode"),onChange:()=>{"light"===r?l("dark"):l("light")}});return(0,s.jsxs)(i,{...d({className:(0,y.A)("px-px transition-opacity hover:opacity-80 cursor-pointer",t,null==a?void 0:a.base)}),children:[(0,s.jsx)(j.s,{children:(0,s.jsx)("input",{...x()})}),(0,s.jsx)("div",{...h(),className:c.wrapper({class:(0,y.A)(["w-auto h-auto","bg-transparent","rounded-lg","flex items-center justify-center","group-data-[selected=true]:bg-transparent","!text-default-500","pt-px","px-0","mx-0"],null==a?void 0:a.wrapper)}),children:!o||n?(0,s.jsx)(b.Kg,{size:22}):(0,s.jsx)(b.ho,{size:22})})]})};var N=a(12115),C=a(40625);let z=async e=>{let t=await fetch("".concat(g.backend.serverSide,"/tasks"),{next:{revalidate:!1},method:"POST",cache:"no-store",body:e});if(!t.ok)throw Error("Failed to send tasks");return t},P=e=>{let t=(0,s.jsx)(c.r,{isClearable:!0,"aria-label":"Filter",classNames:{inputWrapper:"bg-default-100",input:"text-sm"},labelPlacement:"outside",placeholder:"filter...",startContent:(0,s.jsx)(b.WI,{className:"text-base text-default-400 pointer-events-none flex-shrink-0 mr-1"}),type:"search",value:e.containsText,onValueChange:e.updateContains}),{isOpen:a,onOpen:g,onClose:j}=(0,d.j)(),[p,k]=(0,N.useState)(""),[v,y]=(0,N.useState)(!0),[P,S]=(0,N.useState)(!1);return(0,s.jsxs)(r.H,{maxWidth:"sm",position:"sticky",children:[(0,s.jsxs)(l.t,{className:"basis-1/5 sm:basis-full",justify:"start",children:[(0,s.jsxs)(n.p,{className:"hidden md:flex",children:[(0,s.jsx)(i.T,{isIconOnly:!0,className:"text-sm font-normal text-default-600 bg-default-100",startContent:(0,s.jsx)(b.WS,{className:"text-danger-500"}),onPress:e=>{g()},variant:"flat"}),(0,s.jsx)(x.Y,{isOpen:a,onClose:j,size:"xl",placement:"center",children:(0,s.jsx)(h.g,{children:e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.c,{className:"flex flex-col gap-2",children:"Create Tasks"}),(0,s.jsx)(m.h,{children:(0,s.jsx)(o.P,{minRows:8,maxRows:8,isInvalid:P,value:p,onValueChange:e=>{S(!1),k(e)},placeholder:"One meta link per line. Click 'Submit' to send them over.",errorMessage:"Links should not be empty."})}),(0,s.jsxs)(f.q,{children:[(0,s.jsx)(i.T,{color:"danger",variant:"light",onPress:e,children:"Close"}),(0,s.jsx)(i.T,{color:"primary",onPress:e=>{v&&(""==p.trim()?S(!0):(y(!1),z(p).then(()=>{(0,C.$U)({title:"Submitted.",color:"primary"})}).catch(e=>{(0,C.$U)({title:"Submitting tasks failed: ".concat(e),color:"danger"})}).finally(()=>y(!0)),k("")))},children:"Submit"})]})]})})})]}),(0,s.jsx)(n.p,{className:"hidden sm:flex gap-2",children:(0,s.jsx)(w,{})})]}),(0,s.jsx)(l.t,{className:"hidden sm:flex basis-1/5 sm:basis-full",justify:"end",children:(0,s.jsx)(n.p,{className:"hidden lg:flex",children:t})})]})};var S=a(85682);function T(e){let t=async e=>await fetch("".concat(g.backend.serverSide,"/task/").concat(e),{method:"DELETE",next:{revalidate:!1},cache:"no-store"}).catch(e=>{(0,C.$U)({title:"Submitting deletion failed: ".concat(e),color:"danger"})}),a=async e=>await fetch("".concat(g.backend.serverSide,"/task/").concat(e,"/reset"),{method:"POST",next:{revalidate:!1},cache:"no-store"}).catch(e=>{(0,C.$U)({title:"Submitting restart failed: ".concat(e),color:"danger"})}),r=e=>new Promise(t=>setTimeout(t,e)),[l,n]=(0,N.useState)(!0),[c,o]=(0,N.useState)(!0);return(0,s.jsx)("div",{className:"ring-2 ring-slate-300 m-4 rounded-[12px] p-6",children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"flex flex-row items-start justify-between",children:[(0,s.jsx)("a",{href:"".concat(e.task.galleryUri),target:"_blank",rel:"noreferrer",className:"basis-5/6 mr-6",children:(0,s.jsx)("div",{className:"flex flex-col",children:(t=>{function a(e,s){if(""==e)return s;if(e.startsWith(t)){let r=0,l="";for(;;){if(!e.startsWith(t,r))return a(e.substring(r),s.concat(l));l+=t,r+=t.length}}else{let r=e.indexOf(t);if(-1==r)return s.concat(e);{let t=e.substring(0,r);return a(e.substring(r),s.concat(t))}}}let r=e=>(0,s.jsx)("span",{className:"text-red-600",children:e});if(""==t)return!0==e.task.isParsed?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"text-xl text-gray-700 dark:text-gray-100 text-left",children:e.task.title}),(0,s.jsx)("div",{className:"text-md text-gray-300 dark:text-gray-400 text-left",children:e.task.galleryUri})]}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"text-lg text-gray-400 dark:text-gray-200 text-left mt-2",children:e.task.galleryUri})});if(!0==e.task.isParsed){let l=a(e.task.title,[]).map(e=>e.includes(t)?r(e):e),n=a(e.task.galleryUri,[]).map(e=>e.includes(t)?r(e):e);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"text-xl text-gray-700 dark:text-gray-100 text-left",children:l}),(0,s.jsx)("div",{className:"text-md text-gray-400 text-left",children:n})]})}{let l=a(e.task.galleryUri,[]).map(e=>e.includes(t)?r(e):e);return(0,s.jsx)("div",{className:"text-lg text-gray-500 dark:text-gray-200 text-left mt-2",children:l})}})(e.filterText.trimEnd())})}),-1==e.task.state||-2==e.task.state||3==e.task.state?(0,s.jsx)(()=>c?(0,s.jsx)(i.T,{isIconOnly:!0,className:"text-sm font-normal ml-1 mt-2",startContent:(0,s.jsx)(b.zD,{className:"text-gray-300"}),onPress:t=>{o(!1),a(e.task.id).finally(async()=>{await r(1100),o(!0)})},variant:"light"}):(0,s.jsx)(i.T,{isDisabled:!0,isIconOnly:!0,className:"text-sm font-normal ml-1 mt-2",startContent:(0,s.jsx)(b.zD,{className:"text-gray-300"}),variant:"light"}),{}):(0,s.jsx)(s.Fragment,{}),(0,s.jsx)(()=>l?(0,s.jsx)(i.T,{isIconOnly:!0,className:"text-sm font-normal ml-1 mt-2",startContent:(0,s.jsx)(b.d7,{className:"text-gray-300"}),onPress:a=>{n(!1),t(e.task.id).finally(async()=>{await r(1100),n(!0)})},variant:"light"}):(0,s.jsx)(i.T,{isDisabled:!0,isIconOnly:!0,className:"text-sm font-normal ml-1 mt-2",startContent:(0,s.jsx)(b.d7,{className:"text-gray-300"}),variant:"light"}),{})]}),(0,s.jsx)(S.o,{className:"text-sm ".concat((()=>{switch(e.task.state){case 2:return"text-blue-500";case 3:return"text-yellow-500";case 4:return"text-green-400";case -2:return"text-red-500";default:return"text-gray-400"}})()," pl-1 pt-2 pr-6"),label:(()=>{switch(e.task.state){case 0:return"Pending...";case 1:return"Waiting for handler...";case 2:var t;return e.task.isParsed?"".concat(e.task.completedPages," / ").concat(e.task.totalPages):"Parsing...";case 3:return"Partially Completed: ".concat(e.task.completedPages," / ").concat(e.task.totalPages);case 4:return"".concat(e.task.completedPages," / ").concat(e.task.totalPages);case -2:return"Failed";case -1:return"Interrupted";default:return"Unknown"}})(),color:(()=>{switch(e.task.state){case 2:return"primary";case 3:return"warning";case 4:return"success";case -2:return"danger";default:return"default"}})(),size:"md",value:e.task.completedPages/e.task.totalPages*100}),-2==e.task.state?(0,s.jsxs)("div",{className:"text-sm text-red-500 text-left pl-1 pr-10 pt-3",children:["Error: ",e.task.cause]}):(0,s.jsx)(s.Fragment,{})]})})}async function E(){let e=await fetch("".concat(g.backend.serverSide,"/tasks"),{next:{revalidate:!1},cache:"no-store"});if(!e.ok)throw Error("Failed to fetch tasks");return await e.json()}function M(e){let[t,a]=(0,N.useState)();return(0,N.useEffect)(()=>{let e=setInterval(async()=>{a(await E().catch(e=>void 0))},1100);return()=>clearInterval(e)},[]),(0,s.jsxs)("div",{className:"inline-block text-center min-w-full justify-center",children:[""==e.filterText.trimEnd()?(0,s.jsx)(s.Fragment,{}):(0,s.jsxs)("div",{className:"text-lg",style:{whiteSpace:"pre"},children:["Contains: ",e.filterText.trimEnd()]}),void 0==t||t.length<1?(0,s.jsx)("h5",{className:"mt-28 text-gray-400",children:"No tasks now."}):function(t){let a;let r=t.filter(t=>t.galleryUri.includes(e.filterText.trimEnd())||void 0!=t.title&&t.title.includes(e.filterText.trimEnd()));return r.length<1?(0,s.jsx)("h5",{className:"mt-32 text-gray-400",children:"No tasks with filter."}):r.map(t=>(0,s.jsx)(T,{task:t,filterText:e.filterText},t.id))}(t)]})}function W(){let[e,t]=(0,N.useState)("");return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(P,{containsText:e,updateContains:e=>t(e)}),(0,s.jsx)("main",{className:"container mx-auto max-w-2xl pt-16 px-6 flex-grow",children:(0,s.jsx)("section",{className:"flex flex-col items-center justify-center gap-4",children:(0,s.jsx)(M,{filterText:e})})})]})}},72350:(e,t,a)=>{Promise.resolve().then(a.bind(a,44620))},78519:(e,t,a)=>{"use strict";a.d(t,{Kg:()=>l,WI:()=>n,WS:()=>i,Xr:()=>d,d7:()=>o,ho:()=>r,zD:()=>c});var s=a(95155);a(12115);let r=e=>{let{size:t=24,width:a,height:r,...l}=e;return(0,s.jsx)("svg",{"aria-hidden":"true",focusable:"false",height:t||r,role:"presentation",viewBox:"0 0 24 24",width:t||a,...l,children:(0,s.jsx)("path",{d:"M21.53 15.93c-.16-.27-.61-.69-1.73-.49a8.46 8.46 0 01-1.88.13 8.409 8.409 0 01-5.91-2.82 8.068 8.068 0 01-1.44-8.66c.44-1.01.13-1.54-.09-1.76s-.77-.55-1.83-.11a10.318 10.318 0 00-6.32 10.21 10.475 10.475 0 007.04 8.99 10 10 0 002.89.55c.16.01.32.02.48.02a10.5 10.5 0 008.47-4.27c.67-.93.49-1.519.32-1.79z",fill:"currentColor"})})},l=e=>{let{size:t=24,width:a,height:r,...l}=e;return(0,s.jsx)("svg",{"aria-hidden":"true",focusable:"false",height:t||r,role:"presentation",viewBox:"0 0 24 24",width:t||a,...l,children:(0,s.jsxs)("g",{fill:"currentColor",children:[(0,s.jsx)("path",{d:"M19 12a7 7 0 11-7-7 7 7 0 017 7z"}),(0,s.jsx)("path",{d:"M12 22.96a.969.969 0 01-1-.96v-.08a1 1 0 012 0 1.038 1.038 0 01-1 1.04zm7.14-2.82a1.024 1.024 0 01-.71-.29l-.13-.13a1 1 0 011.41-1.41l.13.13a1 1 0 010 1.41.984.984 0 01-.7.29zm-14.28 0a1.024 1.024 0 01-.71-.29 1 1 0 010-1.41l.13-.13a1 1 0 011.41 1.41l-.13.13a1 1 0 01-.7.29zM22 13h-.08a1 1 0 010-2 1.038 1.038 0 011.04 1 .969.969 0 01-.96 1zM2.08 13H2a1 1 0 010-2 1.038 1.038 0 011.04 1 .969.969 0 01-.96 1zm16.93-7.01a1.024 1.024 0 01-.71-.29 1 1 0 010-1.41l.13-.13a1 1 0 011.41 1.41l-.13.13a.984.984 0 01-.7.29zm-14.02 0a1.024 1.024 0 01-.71-.29l-.13-.14a1 1 0 011.41-1.41l.13.13a1 1 0 010 1.41.97.97 0 01-.7.3zM12 3.04a.969.969 0 01-1-.96V2a1 1 0 012 0 1.038 1.038 0 01-1 1.04z"})]})})},n=e=>(0,s.jsxs)("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",viewBox:"0 0 24 24",width:"1em",...e,children:[(0,s.jsx)("path",{d:"M11.5 21C16.7467 21 21 16.7467 21 11.5C21 6.25329 16.7467 2 11.5 2C6.25329 2 2 6.25329 2 11.5C2 16.7467 6.25329 21 11.5 21Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"}),(0,s.jsx)("path",{d:"M22 22L20 20",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"})]}),i=e=>{let{size:t=24,width:a,height:r,...l}=e;return(0,s.jsx)("svg",{"aria-hidden":"true",focusable:"false",height:32,role:"presentation",viewBox:"0 0 1024 1024",width:32,...l,children:(0,s.jsx)("path",{d:"M814.4 453.2H597.6c-14.8 0-26.8-12-26.8-26.8V209.6c0-32.2-25.6-59.1-57.8-59.6-32.8-0.5-59.7 26-59.7 58.7v217.7c0 14.8-12 26.8-26.8 26.8H209.6c-32.2 0-59.1 25.6-59.6 57.8-0.5 32.8 26 59.7 58.7 59.7h217.7c14.8 0 26.8 12 26.8 26.8v216.8c0 32.2 25.6 59.1 57.8 59.6 32.8 0.5 59.7-26 59.7-58.7V597.6c0-14.8 12-26.8 26.8-26.8h217.7c32.7 0 59.2-26.8 58.7-59.7-0.4-32.2-27.3-57.9-59.5-57.9z",fill:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.5})})},c=e=>{let{size:t=24,width:a,height:r,...l}=e;return(0,s.jsx)("svg",{"aria-hidden":"true",focusable:"false",height:32,role:"presentation",viewBox:"0 0 1024 1024",width:32,...l,children:(0,s.jsx)("path",{d:"M981.723429 590.482286h0.146285a475.574857 475.574857 0 0 1-945.298285-73.142857A475.428571 475.428571 0 0 1 512 41.910857c139.776 0 269.312 60.928 358.473143 163.620572v-66.852572a58.514286 58.514286 0 1 1 116.955428 0v206.116572a58.514286 58.514286 0 0 1-58.514285 58.514285l-225.206857-2.194285a58.514286 58.514286 0 1 1 0.292571-116.882286l81.334857 1.462857A357.229714 357.229714 0 0 0 512 158.793143a358.473143 358.473143 0 1 0 351.085714 431.689143h0.073143c3.145143-32.621714 22.820571-59.538286 56.612572-59.538286s61.805714 25.746286 61.952 59.538286z",fill:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.5})})},o=e=>{let{size:t=24,width:a,height:r,...l}=e;return(0,s.jsx)("svg",{"aria-hidden":"true",focusable:"false",height:32,role:"presentation",viewBox:"0 0 1024 1024",width:32,...l,children:(0,s.jsx)("path",{d:"M799.2 874.4c0 34.4-28.001 62.4-62.4 62.4H287.2c-34.4 0-62.4-28-62.4-62.4V212h574.4v662.4zM349.6 100c0-7.2 5.6-12.8 12.8-12.8h300c7.2 0 12.8 5.6 12.8 12.8v37.6H349.6V100z m636.8 37.6H749.6V100c0-48.001-39.2-87.2-87.2-87.2h-300c-48 0-87.2 39.199-87.2 87.2v37.6H37.6C16.8 137.6 0 154.4 0 175.2s16.8 37.6 37.6 37.6h112v661.6c0 76 61.6 137.6 137.6 137.6h449.6c76 0 137.6-61.6 137.6-137.6V212h112c20.8 0 37.6-16.8 37.6-37.6s-16.8-36.8-37.6-36.8zM512 824c20.8 0 37.6-16.8 37.6-37.6v-400c0-20.8-16.8-37.6-37.6-37.6s-37.6 16.8-37.6 37.6v400c0 20.8 16.8 37.6 37.6 37.6m-175.2 0c20.8 0 37.6-16.8 37.6-37.6v-400c0-20.8-16.8-37.6-37.6-37.6s-37.6 16.8-37.6 37.6v400c0.8 20.8 17.6 37.6 37.6 37.6m350.4 0c20.8 0 37.6-16.8 37.6-37.6v-400c0-20.8-16.8-37.6-37.6-37.6s-37.6 16.8-37.6 37.6v400c0 20.8 16.8 37.6 37.6 37.6",fill:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.5})})},d=e=>{let{size:t=24,width:a,height:r,...l}=e;return(0,s.jsx)("svg",{"aria-hidden":"true",focusable:"false",height:24,role:"presentation",viewBox:"0 0 1024 1024",width:24,...l,children:(0,s.jsx)("path",{d:"M855.848421 106.442105a42.469053 42.469053 0 0 1-42.469053 42.469053H203.452632a42.469053 42.469053 0 0 1 0-84.938105h609.926736c23.498105 0 42.469053 19.024842 42.469053 42.469052z m-344.010105 157.911579a42.469053 42.469053 0 0 0-42.469053 42.469053V916.749474a42.469053 42.469053 0 1 0 84.938105 0V306.822737a42.469053 42.469053 0 0 0-42.469052-42.469053z m30.127158-31.312842c-16.599579-16.599579-42.522947-17.569684-57.936842-2.155789l-312.751158 312.805052c-15.413895 15.413895-14.497684 41.337263 2.101894 57.936842 16.599579 16.545684 42.522947 17.515789 57.936843 2.101895l312.751157-312.805053c15.413895-15.36 14.497684-41.337263-2.155789-57.882947z m-60.254316 0c-16.599579 16.545684-17.569684 42.522947-2.15579 57.882947l312.805053 312.805053c15.413895 15.413895 41.337263 14.443789 57.936842-2.155789 16.545684-16.545684 17.515789-42.469053 2.15579-57.882948l-312.805053-312.805052c-15.413895-15.413895-41.391158-14.443789-57.936842 2.155789z",fill:"#666666"})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[144,853,441,684,358],()=>t(72350)),_N_E=e.O()}]);